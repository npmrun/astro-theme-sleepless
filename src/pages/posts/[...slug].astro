---
import { getCollection, getEntries, getEntry } from 'astro:content'
import SinglePage from '@blog/layouts/SinglePage.astro'
// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
    const blogEntries = await getCollection('posts')
    return blogEntries.map((entry) => ({
        params: { slug: entry.slug },
        props: { entry },
    }))
}
// 2. For your template, you can get the entry directly from the prop
const { entry } = Astro.props
const { Content } = await entry.render()

let author
if (entry.data.author) {
    author = (await getEntry(entry.data.author)) as any
}

let relatedPosts
if (entry.data.relatedPosts) {
    relatedPosts = await getEntries(entry.data.relatedPosts)
}
---

<SinglePage>
    <a href="/">返回首页</a>
    <article class="markdown-body green">
        <h1>{entry.data.title}</h1>
        <p>Author: {author?.data.name}</p>
        <Content />

        <h2>You might also like:</h2>
        {
            relatedPosts &&
                relatedPosts.map((p) => <a href={p.slug}>{p.data.title}</a>)
        }
    </article>
</SinglePage>
